<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="This page describes how to add a custom processing module into the FMCOMMS2’s TX and/or RX data path." name="description" />

    <title>Integrate FIR filters into the FMCOMMS2 HDL design &#8212; HDL  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8e8a900e" />
    <link rel="stylesheet" type="text/css" href="../../_static/app.min.css?v=5d595293" />
    <script async="async" src="../../_static/app.umd.js?v=46a18818"></script>
    <link rel="icon" href="../../_static/icon.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="FMCOMMS5 HDL Project" href="../fmcomms5/index.html" />
    <link rel="prev" title="FMCOMMS2/3/4 HDL Project" href="index.html" />
   
  
  
  <meta name="repository" content="hdl">
  <meta name="version" content="">
  
    <meta name="page_source_suffix" content=".rst">
  
  
  


<style>
  body {
    
  }

  body.dark {
    
  }

  @media (prefers-color-scheme: dark) {
    body:not(.light) {
      
    }
  }
</style>
  </head>
  
    <body>
  
  <input type="checkbox" id="input-show-toc">
  <input type="checkbox" id="input-show-localtoc">
  <input type="checkbox" id="input-show-repotoc">

  
  <div class="search-area">
    <form action="" method="get">
      <input type="text" name="q" aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="search" placeholder="Search"/>
      <button class="icon"></button>
    </form>
  </div>
  

  <header>
    <div id="left">
      <label id="show-sidebar" class="icon" for="input-show-toc" title="Show/hide index"></label>
    </div>
    <div id="right">
      <span>
        <a id="logo-org" href="https://analog.com" aria-label="Analog Devices Inc. landing page"></a>
        <div class="vertical-divider"></div>
        
        <label id="show-repotoc" for="input-show-repotoc" title="Show/hide docs" tabindex="0">Docs</label>
        
        <a id="logo" href="../../index.html">
          <div>HDL</div>
        </a>
      </span>
      <span class="reverse">
        <label id="show-localtoc" class="icon" for="input-show-localtoc" title="Show/hide contents"></label>
      </span>
    </div>
  </header>


  <div class="repotoc-tree overlay">
    <root>
  <a href="../../index.html" class="current">HDL</a>
</root>

  </div>
    <div class="localtoc">
      <div class="tocwrapper">
        <div class="header localtoc-header">
          <a id="scroll-up" href="#top-anchor" title="Back to top"></a>
        </div>
        <nav>
          <ul>
<li><a class="reference internal" href="#">Integrate FIR filters into the FMCOMMS2 HDL design</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#choosing-filter-parameters-and-coefficients">Choosing filter parameters and coefficients</a><ul>
<li><a class="reference internal" href="#interpolation-fir-filter">Interpolation FIR filter</a></li>
<li><a class="reference internal" href="#decimation-fir-filter">Decimation FIR filter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-the-filters-in-the-data-path">Adding the filters in the data path</a></li>
<li><a class="reference internal" href="#block-diagram">Block diagram</a></li>
<li><a class="reference internal" href="#understanding-fmcomms2-clock-routing">Understanding FMCOMMS2 clock routing</a></li>
<li><a class="reference internal" href="#adding-fir-filters-in-fmcomms2-design-and-building-the-hdl">Adding FIR filters in FMCOMMS2 design and building the HDL</a><ul>
<li><a class="reference internal" href="#adding-concatenation-modules">Adding concatenation modules</a></li>
<li><a class="reference internal" href="#connecting-the-fir-interpolation-filters-on-the-tx-side">Connecting the FIR interpolation filters on the Tx side</a></li>
<li><a class="reference internal" href="#connecting-the-fir-decimation-filters-on-the-rx-side">Connecting the FIR decimation filters on the Rx side</a></li>
<li><a class="reference internal" href="#generating-the-programing-files">Generating the programing files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#base-system-functionality">Base system functionality</a></li>
<li><a class="reference internal" href="#activating-filters">Activating Filters</a><ul>
<li><a class="reference internal" href="#interpolation-filter">Interpolation filter</a></li>
<li><a class="reference internal" href="#decimation-filters">Decimation filters</a></li>
<li><a class="reference internal" href="#all-filters-active-characteristic">All filters active characteristic</a></li>
</ul>
</li>
<li><a class="reference internal" href="#older-sources">Older sources</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

        </nav>
      </div>
    </div>

  
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
    <a id="logo" href="../../index.html">
      <img class="only-light" src="../../_static/HDL_logo_cropped.svg"/>
      <img class="only-dark" src="../../_static/HDL_logo_w_cropped.svg"/>
    </a><input id="input-switch-toc" type="checkbox">
<label id="show-repotoc" for="input-switch-toc">
All content
</label>
<label id="show-toc" for="input-switch-toc">
Content on this topic
</label>
<div class="repotoc-tree">
  <root>
  <a href="../../index.html" class="current">HDL</a>
</root>

</div>
<div class="toc-tree">
  <html>
  <body><ul>
<li class="toctree-l1"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-1" id="toctree-collapse-1"/><div class="collapse"><a class="reference internal" href="../../user_guide/index.html">User Guide</a><label for="toctree-collapse-1"><div class="icon"></div></label></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/git_repository.html">Git repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/releases.html">Releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/build_hdl.html">Build an HDL project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/build_boot_bin.html">Build the BOOT.BIN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/build_intel_boot_image.html">Build the Intel Boot Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/architecture.html">HDL architecture</a></li>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-1-1" id="toctree-collapse-1-1"/><div class="collapse"><a class="reference internal" href="../../user_guide/ip_cores/index.html">IP cores</a><label for="toctree-collapse-1-1"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/ip_cores/creating_new_ip.html">Creating a new IP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/ip_cores/use_adi_ips.html">Use ADI IPs into your own project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/ip_cores/interfaces.html">Interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/ip_cores/axi_adc/index.html">Generic AXI ADC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/ip_cores/axi_dac/index.html">Generic AXI DAC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/porting_project.html">Porting HDL projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/customize_hdl.html">Customize HDL projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hdl_coding_guidelines.html">HDL coding guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/docs_guidelines.html">Documentation guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/contributing.html">Contributing to HDL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/third_party.html">Third party forks</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2" id="toctree-collapse-2"/><div class="collapse"><a class="reference internal" href="../../library/index.html">IP Cores</a><label for="toctree-collapse-2"><div class="icon"></div></label></div><ul>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-1" id="toctree-collapse-2-1"/><div class="collapse"><a class="reference internal" href="../../library/i3c_controller/index.html">I3C Controller</a><label for="toctree-collapse-2-1"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/i3c_controller/i3c_controller_host_interface.html">Host Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/i3c_controller/i3c_controller_core.html">Core Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/i3c_controller/interface.html">Interface</a></li>
</ul>
</li>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-2" id="toctree-collapse-2-2"/><div class="collapse"><a class="reference internal" href="../../library/jesd204/index.html">JESD204 Interface Framework</a><label for="toctree-collapse-2-2"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/jesd204/generic_jesd_bds/index.html">Generic JESD204 block designs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/jesd204/axi_jesd204_tx/index.html">JESD204B/C Link Transmit Peripheral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/jesd204/axi_jesd204_rx/index.html">JESD204B/C Link Receive Peripheral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/jesd204/ad_ip_jesd204_tpl_adc/index.html">ADC JESD204B/C Transport Peripheral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/jesd204/ad_ip_jesd204_tpl_dac/index.html">DAC JESD204B/C Transport Peripheral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/jesd204/xgt_wizard/index.html">Xilinx FPGAs Transceivers Wizard</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/jesd204/versal_transceiver_subsystem/index.html">AMD Versal Adaptive SoC Transceiver Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/jesd204/troubleshoot/troubleshoot_jesd204_tx.html">Troubleshooting JESD204 TX links</a></li>
</ul>
</li>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-3" id="toctree-collapse-2-3"/><div class="collapse"><a class="reference internal" href="../../library/spi_engine/index.html">SPI Engine</a><label for="toctree-collapse-2-3"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/spi_engine/spi_engine_execution.html">Execution Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/spi_engine/axi_spi_engine.html">AXI Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/spi_engine/spi_engine_offload.html">Offload Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/spi_engine/spi_engine_interconnect.html">Interconnect Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/spi_engine/control-interface.html">Control Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/spi_engine/offload-control-interface.html">Offload Control Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/spi_engine/spi-bus-interface.html">SPI Bus Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/spi_engine/instruction-format.html">Instruction Set Specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/spi_engine/pipeline-delays.html">Pipeline Delays</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/spi_engine/tutorial.html">Tutorial - PulSAR ADC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad35xxr/index.html">AXI AD35XXR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad408x/index.html">AXI AD408x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad485x/index.html">AXI AD485x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad7405/index.html">AXI AD7405</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad7606x/index.html">AXI AD7606x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad7616/index.html">AXI AD7616</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad7768/index.html">AXI AD7768</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad777x/index.html">AXI AD777x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad9265/index.html">AXI AD9265</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad9361/index.html">AXI AD9361</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad9467/index.html">AXI AD9467</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad9783/index.html">AXI AD9783</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad9963/index.html">AXI AD9963</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ada4355/index.html">AXI ADA4355</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_adaq8092/index.html">AXI ADAQ8092</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_adrv9001/index.html">AXI ADRV9001</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ltc235x/index.html">AXI LTC235X</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ltc2387/index.html">AXI LTC2387</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/data_offload/index.html">Data Offload</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_dmac/index.html">AXI DMAC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_hdmi_rx/index.html">AXI HDMI RX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_hdmi_tx/index.html">AXI HDMI TX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_adc_decimate/index.html">AXI ADC Decimate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_adc_trigger/index.html">AXI ADC Trigger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_adxcvr/index.html">AXI ADXCVR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_clkgen/index.html">AXI CLK Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_clock_monitor/index.html">AXI Clock Monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_dac_interpolate/index.html">AXI DAC Interpolate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_fan_control/index.html">AXI Fan Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_laser_driver/index.html">AXI Laser Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_logic_analyzer/index.html">AXI Logic Analyzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_pwm_gen/index.html">AXI PWM Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_sysid/index.html">AXI System ID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_tdd/index.html">AXI TDD</a></li>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-4" id="toctree-collapse-2-4"/><div class="collapse"><a class="reference internal" href="../../library/cn0363/index.html">CN0363</a><label for="toctree-collapse-2-4"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/cn0363/cn0363_dma_sequencer.html">CN0363 DMA Sequencer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/cn0363/cn0363_phase_data_sync.html">CN0363 Phase Data Sync</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/common/ad_dds/index.html">AD Direct Digital Synthesis</a></li>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-5" id="toctree-collapse-2-5"/><div class="collapse"><a class="reference internal" href="../../library/corundum/index.html">Corundum Network Stack</a><label for="toctree-collapse-2-5"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/corundum/corundum_core/index.html">Corundum Core</a></li>
<li class="toctree-l3"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-5-1" id="toctree-collapse-2-5-1"/><div class="collapse"><a class="reference internal" href="../../library/corundum/ethernet/index.html">Corundum Ethernet Core</a><label for="toctree-collapse-2-5-1"><div class="icon"></div></label></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/corundum/ethernet/vcu118/index.html">VCU118</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/corundum/ethernet/k26/index.html">K26</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/util_axis_fifo/index.html">AXI Stream FIFO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/util_axis_fifo_asym/index.html">Asymmetric AXI Stream FIFO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/util_extract/index.html">Util Extract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/util_mii_to_rmii/index.html">Util MII to RMII</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/util_pack/util_cpack2.html">Channel CPACK Utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/util_pack/util_upack2.html">Channel UPACK Utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/util_rfifo/index.html">Util RFIFO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/util_sigma_delta_spi/index.html">Util Sigma Delta SPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/util_var_fifo/index.html">Util VAR FIFO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/util_wfifo/index.html">Util WFIFO</a></li>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-6" id="toctree-collapse-2-6"/><div class="collapse"><a class="reference internal" href="../../library/xilinx/index.html">AMD Xilinx Specific IPs</a><label for="toctree-collapse-2-6"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/xilinx/util_adxcvr/index.html">UTIL_ADXCVR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad9643/index.html">AXI AD9643 (OBSOLETE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../library/axi_ad9671/index.html">AXI AD9671 (OBSOLETE)</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-3" id="toctree-collapse-3" checked=""/><div class="collapse"><a class="reference internal" href="../index.html">Projects</a><label for="toctree-collapse-3"><div class="icon"></div></label></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../ad_gmsl2eth_sl/index.html">AD-GMSL2ETH-SL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad_quadmxfe1_ebz/index.html">AD-QUADMXFE1-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad353xr/index.html">AD353XR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad35xxr_evb/index.html">AD35XXR-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad4052_ardz/index.html">AD4052-ARDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad4062_ardz/index.html">AD4062-ARDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad4080_fmc_evb/index.html">AD4080-FMC-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad4110/index.html">AD4110-SDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad411x_ad717x/index.html">AD411x-AD717x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad4134_fmc/index.html">AD4134-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad4170_asdz/index.html">AD4170-ASDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad4630_fmc/index.html">AD4630-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad469x_evb/index.html">AD469X-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad485x_fmcz/index.html">AD485X-FMCZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad488x_fmc_evb/index.html">AD488X-FMC-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad5758_sdz/index.html">AD5758-SDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad5766_sdz/index.html">AD5766-SDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad57xx_ardz/index.html">AD57XX-ARDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad6676evb/index.html">AD6676EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad7124_asdz/index.html">AD7124-ASDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad7134_fmc/index.html">AD7134-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad719x_asdz/index.html">AD719X-ASDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad738x_fmc/index.html">AD738X-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad7405_fmc/index.html">AD7405-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad7606x_fmc/index.html">AD7606X-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad7616_sdz/index.html">AD7616-SDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad77681evb/index.html">AD7768-1-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad7768evb/index.html">AD7768-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad777x_fmcz/index.html">AD777X-FMCZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9081_fmca_ebz/index.html">AD9081-FMCA-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9081_fmca_ebz_x_band/index.html">AD9081-FMCA-EBZ-X-BAND</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9083_evb/index.html">AD9083-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9084_ebz/index.html">AD9084-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad916x_fmc/index.html">AD916x-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9208_dual_ebz/index.html">AD9208-DUAL-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9209_fmca_ebz/index.html">AD9209-FMCA-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9213_dual_ebz/index.html">AD9213-DUAL-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9213_evb/index.html">AD9213-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9265_fmc/index.html">AD9265-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9434_fmc/index.html">AD9434-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9467_fmc/index.html">AD9467-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9656_fmc/index.html">AD9656-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9694_fmc/index.html">AD9694-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9695_fmc/index.html">AD9695-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9783_ebz/index.html">AD9783-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ada4355_fmc/index.html">ADA4355-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adaq23875/index.html">ADAQ23875</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adaq7980_sdz/index.html">ADAQ7980-SDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adaq8092_fmc/index.html">ADAQ8092-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../admx100x_evb/index.html">ADMX100X-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../admx6001_ebz/index.html">ADMX6001-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adrv9001/index.html">ADRV9001</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adrv9001_dual/index.html">ADRV9001-DUAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adrv9009/index.html">ADRV9009</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adrv9009zu11eg/index.html">ADRV9009-ZU11EG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adrv9026/index.html">ADRV9026</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adrv904x/index.html">ADRV904x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adrv9361z7035/index.html">ADRV9361Z7035</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adrv9364z7020/index.html">ADRV9364Z7020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adrv9371x/index.html">ADRV9371x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adv7511/index.html">ADV7511</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adv7513/index.html">ADV7513</a></li>
<li class="toctree-l2"><a class="reference internal" href="../arradio/index.html">ARRADIO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cn0363/index.html">CN0363</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cn0506/index.html">CN0506</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cn0540/index.html">CN0540</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cn0561/index.html">CN0561</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cn0577/index.html">CN0577</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cn0579/index.html">CN0579</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cn0585/index.html">CN0585</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dac_fmc_ebz/index.html">DAC-FMC-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../daq2/index.html">DAQ2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../daq3/index.html">DAQ3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dc2677a/index.html">DC2677A</a></li>
<li class="toctree-l2 current"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-3-1" id="toctree-collapse-3-1" checked=""/><div class="collapse"><a class="reference internal" href="index.html">FMCOMMS2/3/4</a><label for="toctree-collapse-3-1"><div class="icon"></div></label></div><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">FMCOMMS2 FIR FILTER</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../fmcomms5/index.html">FMCOMMS5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fmcomms8/index.html">FMCOMMS8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fmcomms11/index.html">FMCOMMS11</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupiter_sdr/index.html">JUPITER-SDR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ltc2378_fmc/index.html">LTC2378-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../m2k/index.html">M2K</a></li>
<li class="toctree-l2"><a class="reference internal" href="../max96724/index.html">MAX96724</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pluto/index.html">PLUTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pulsar_adc/index.html">PULSAR-ADC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pulsar_lvds_adc/index.html">PULSAR-LVDS-ADC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad9739a_fmc/index.html">AD9739A-FMC (OBSOLETE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad_fmclidar1_ebz/index.html">AD-FMCLIDAR1-EBZ (OBSOLETE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fmcadc2/index.html">FMCADC2 (OBSOLETE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fmcadc5/index.html">FMCADC5 (OBSOLETE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fmcjesdadc1/index.html">FMCJESDADC1 (OBSOLETE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imageon/index.html">IMAGEON (OBSOLETE)</a></li>
</ul>
</li>
</ul>
</body>
</html>

</div>
        </div>
      </div>

  <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper" id="top-anchor">
          <div class="body-header">
  <nav class="breadcrumb"><ol><li><a href="../index.html">Projects</a></li><li><a href="index.html">FMCOMMS2/3/4 HDL Project</a></li></ol></nav>
</div>
          <div class="body" role="main">
            
  <section id="integrate-fir-filters-into-the-fmcomms2-hdl-design">
<span id="fir-filter"></span><h1>Integrate FIR filters into the FMCOMMS2 HDL design<a class="headerlink" href="#integrate-fir-filters-into-the-fmcomms2-hdl-design" title="Permalink to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>This page describes how to add a custom processing module into the
<a class="icon git reference external" href="https://github.com/analogdevicesinc/hdl/tree/main/projects/fmcomms2" target="_blank">FMCOMMS2</a>’s TX and/or RX data path.</p>
<p>In this example, the custom modules are going to be some digital FIR filters, to
decimate and interpolate the incoming and outcoming data stream.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This example was built using the hdl_2023_r2 release branch, using Vivado and
Vitis 2023.2. Sources from older examples can be found under the tag
<a class="icon link reference external" href="https://github.com/analogdevicesinc/hdl/releases/tag/eg_fmcomms2_fir_filter" target="_blank">eg_fmcomms2_fir_filter</a> using Vivado 16.2 and 16.4 versions, and status
<strong>are not supported by us anymore</strong>.</p>
</div>
<p>Assuming we want to transmit a sinewave with the <a class="icon adi reference external" href="https://www.analog.com/AD9361" target="_blank">AD9361</a> ADI Integrated RF
transceiver: the sinewave frequency is below 6 MHz, so we can use a lower system
data rate than the reference design. But, by simply lowering the data rate of
the system we will increase the equalization error. To avoid this issue, we can
add some interpolation filters for transmitting.</p>
<p>A similar problem is encountered on the ADC side when receiving a low-frequency
signal. This can be solved with the use of decimation filters. In our example,
these filters were already implemented in
<a class="icon git reference external" href="https://github.com/analogdevicesinc/hdl/tree/main/library/util_fir_int" target="_blank">util_fir_int</a> and
<a class="icon git reference external" href="https://github.com/analogdevicesinc/hdl/tree/main/library/util_fir_dec" target="_blank">util_fir_dec</a> HDL IP cores, which are wrappers
for the FIR Compiler Xilinx IP. The wrappers are used to manage the data rates
entering the filter and to facilitate the configuration of the filter
parameters for a specific application (TX/RX).</p>
</section>
<section id="choosing-filter-parameters-and-coefficients">
<h2>Choosing filter parameters and coefficients<a class="headerlink" href="#choosing-filter-parameters-and-coefficients" title="Permalink to this heading"></a></h2>
<p>The interpolation/decimation filters parameters and coefficients were calculated
in <a class="icon link reference external" href="https://www.mathworks.com/products/matlab.html" target="_blank">MATLAB</a>.</p>
<section id="interpolation-fir-filter">
<h3>Interpolation FIR filter<a class="headerlink" href="#interpolation-fir-filter" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ast</span></code>: normalize stopband attenuation = 80</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tw</span></code>: normalized transition width = 0.1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code>: number of coefficients = 128</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">interp</span></code>: interpolation factor = 8</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ast</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>
<span class="n">tw</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="n">interp</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">fdesign</span><span class="o">.</span><span class="n">interpolator</span><span class="p">(</span><span class="n">interp</span><span class="p">,</span><span class="s1">&#39;Nyquist&#39;</span><span class="p">,</span> <span class="n">interp</span><span class="p">,</span><span class="s1">&#39;N,Ast&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ast</span><span class="p">);</span>
<span class="n">hf</span> <span class="o">=</span> <span class="n">design</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="s1">&#39;kaiserwin&#39;</span><span class="p">);</span>

<span class="n">hq</span> <span class="o">=</span> <span class="n">dfilt</span><span class="o">.</span><span class="n">dffir</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">Numerator</span><span class="o">./</span><span class="n">interp</span><span class="p">);</span><span class="nb">set</span><span class="p">(</span><span class="n">hq</span><span class="p">,</span> <span class="s1">&#39;Arithmetic&#39;</span><span class="p">,</span>  <span class="s1">&#39;fixed&#39;</span><span class="p">);</span>
<span class="n">coewrite</span><span class="p">(</span><span class="n">hq</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;coefile_int_8&#39;</span><span class="p">);</span>

<span class="n">fvtool</span><span class="p">(</span><span class="n">hq</span><span class="p">);</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/fir_interpolation.png"><img alt="FIR_INTERPOLATION block diagram" class="align-center" src="../../_images/fir_interpolation.png" style="width: 1000px;" /></a>
</section>
<section id="decimation-fir-filter">
<h3>Decimation FIR filter<a class="headerlink" href="#decimation-fir-filter" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ast</span></code>: normalize stopband attenuation = 80</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tw</span></code>: normalized transition width = 0.01</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code>: number of coefficients = 128</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">interp</span></code>: interpolation factor = 8</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ast</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>
<span class="n">tw</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span>
<span class="n">decim</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">fdesign</span><span class="o">.</span><span class="n">decimator</span><span class="p">(</span><span class="n">decim</span><span class="p">,</span> <span class="s1">&#39;Nyquist&#39;</span><span class="p">,</span> <span class="n">decim</span><span class="p">,</span><span class="s1">&#39;N, Ast&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ast</span><span class="p">);</span>
<span class="n">hf</span> <span class="o">=</span> <span class="n">design</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>

<span class="n">hq</span> <span class="o">=</span> <span class="n">dfilt</span><span class="o">.</span><span class="n">dffir</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">Numerator</span><span class="p">);</span>
<span class="nb">set</span><span class="p">(</span><span class="n">hq</span><span class="p">,</span> <span class="s1">&#39;Arithmetic&#39;</span><span class="p">,</span>  <span class="s1">&#39;fixed&#39;</span><span class="p">,</span> <span class="s1">&#39;CoeffWordLength&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
<span class="n">coewrite</span><span class="p">(</span><span class="n">hq</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;coefile_dec&#39;</span><span class="p">);</span>

<span class="n">fvtool</span><span class="p">(</span><span class="n">hf</span><span class="p">);</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/fir_decimation.png"><img alt="FIR_DECIMATION block diagram" class="align-center" src="../../_images/fir_decimation.png" style="width: 1000px;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After running the above commands in MATLAB, you will obtain some <em>.coe</em>
files, that will be processed by the Xilinx FIR Compiler IP.</p>
</div>
</section>
</section>
<section id="adding-the-filters-in-the-data-path">
<h2>Adding the filters in the data path<a class="headerlink" href="#adding-the-filters-in-the-data-path" title="Permalink to this heading"></a></h2>
<p>In the original <a class="icon git reference external" href="https://github.com/analogdevicesinc/hdl/tree/main/projects/fmcomms2" target="_blank">fmcomms2</a> design, the data comes
from the <a class="icon git reference external" href="https://github.com/analogdevicesinc/hdl/tree/main/library/axi_dmac" target="_blank">DMA</a>, goes to the
<a class="icon git reference external" href="https://github.com/analogdevicesinc/hdl/tree/main/library/util_pack/util_upack2" target="_blank">util_upack2</a> core which transmits
the individual channel data to a <a class="icon git reference external" href="https://github.com/analogdevicesinc/hdl/tree/main/library/util_rfifo" target="_blank">dac_fifo</a> core,
from which the <a class="icon git reference external" href="https://github.com/analogdevicesinc/hdl/tree/main/library/axi_ad9361" target="_blank">axi_ad9361</a> core reads the data
and transmits it to the <a class="icon adi reference external" href="https://www.analog.com/AD9361" target="_blank">AD9361</a> chip.</p>
<p>The util_upack2 core is used to split the 64-bit data containing 2 RF channels,
each one having I/Q data. dac_fifo is used for clock-domain crossing between
the system clock and the AD9361 clock.</p>
<p>The data processing is done at lower clock frequencies. This is the reason for
placing the interpolation filters in front of the dac_fifo module.</p>
<p>The required input data for the filter is I/Q data and the output is independent
I and Q data. Because of these conditions, we still require the util_upack2
module, but we only need to split the DAC data into independent channel data, so
we need one UPACK module and two <strong>util_fir_int</strong> modules before the FIFO. The
same approach is implemented on the receive path.</p>
<p>For more information about the reference design, visit <a class="reference internal" href="index.html#fmcomms2"><span class="std std-ref">FMCOMMS2/3/4 HDL Project</span></a>
documentation.</p>
</section>
<section id="block-diagram">
<h2>Block diagram<a class="headerlink" href="#block-diagram" title="Permalink to this heading"></a></h2>
<p>The modified reference design block diagram containing now <strong>Interpolation</strong> and
<strong>Decimation</strong> filters is presented below:</p>
<a class="reference internal image-reference" href="../../_images/fmcomms234_fir_filt_block_diagram.svg"><img alt="FMCOMMS2_FIR_FILTERS block diagram" class="align-center" src="../../_images/fmcomms234_fir_filt_block_diagram.svg" width="1000" /></a>
</section>
<section id="understanding-fmcomms2-clock-routing">
<h2>Understanding FMCOMMS2 clock routing<a class="headerlink" href="#understanding-fmcomms2-clock-routing" title="Permalink to this heading"></a></h2>
<a class="reference internal image-reference" href="../../_images/fmcomms234_clock_domains.svg"><img alt="FMCOMMS2 clock domains" class="align-center" src="../../_images/fmcomms234_clock_domains.svg" width="1000" /></a>
</section>
<section id="adding-fir-filters-in-fmcomms2-design-and-building-the-hdl">
<h2>Adding FIR filters in FMCOMMS2 design and building the HDL<a class="headerlink" href="#adding-fir-filters-in-fmcomms2-design-and-building-the-hdl" title="Permalink to this heading"></a></h2>
<p>The design is obtained by simply sourcing the base FMCOMMS2 block design.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="k">set</span><span class="w"> </span>project_dir<span class="w"> </span><span class="k">[</span><span class="nb">pwd</span><span class="k">]</span>
<span class="nb">cd</span><span class="w"> </span><span class="nv">$ad_hdl_dir</span><span class="o">/</span>projects<span class="o">/</span>fmcomms2<span class="o">/</span>zc706<span class="o">/</span>
<span class="nb">source</span><span class="w"> </span>system_project.tcl
<span class="nb">cd</span><span class="w"> </span><span class="nv">$project_dir</span>
</pre></div>
</div>
<p>At this point, FMCOMMS2 reference design’s TX data path has the following
components:</p>
<a class="reference internal image-reference" href="../../_images/fmcomms2_vivado_ref_tx.jpg"><img alt="FMCOMMS2 Vivado TX data path" class="align-center" src="../../_images/fmcomms2_vivado_ref_tx.jpg" style="width: 1000px;" /></a>
<p>We need to remove the connections between util_upack2 and dac_fifo cores so we
can add the FIR filter modules in the reference design. With the following
commands, all the unwanted connections will be removed and new ones will be
created.</p>
<p>All the TCL commands from this page are available in the
<a class="icon git reference external" href="https://github.com/analogdevicesinc/hdl/tree/main/docs/projects/fmcomms2/fir_filter.tcl" target="_blank">docs/projects/fmcomms2/fir_filter.tcl</a> script located in
<cite>hdl/docs/projects/fmcomms2</cite>.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="c"># delete reference design connections</span>
<span class="nv">delete_bd_objs</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_nets</span><span class="w"> </span>axi_ad9361_dac_fifo_din_valid_0<span class="k">]</span>
<span class="nv">delete_bd_objs</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_nets</span><span class="w"> </span>axi_ad9361_dac_fifo_din_enable_<span class="o">*</span><span class="k">]</span>
<span class="nv">delete_bd_objs</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_nets</span><span class="w"> </span>util_ad9361_dac_upack_fifo_rd_data_<span class="o">*</span><span class="k">]</span>
<span class="nv">delete_bd_objs</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_nets</span><span class="w"> </span>util_ad9361_dac_upack_fifo_rd_underflow<span class="k">]</span>
<span class="nv">delete_bd_objs</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_nets</span><span class="w"> </span>util_ad9361_dac_upack_fifo_rd_valid<span class="k">]</span>
</pre></div>
</div>
<p>We will disconnect/connect the Rx path in a similar manner.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="nv">delete_bd_objs</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_nets</span><span class="w"> </span>util_ad9361_adc_fifo_dout_valid_0<span class="k">]</span>
<span class="nv">delete_bd_objs</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_nets</span><span class="w"> </span>util_ad9361_adc_fifo_dout_enable_<span class="o">*</span><span class="k">]</span>
<span class="nv">delete_bd_objs</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_nets</span><span class="w"> </span>util_ad9361_adc_fifo_dout_data_<span class="o">*</span><span class="k">]</span>
</pre></div>
</div>
<p>Add the two required IP cores to the Makefile:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LIB_DEPS</span> <span class="o">+=</span> <span class="n">util_fir_int</span>
<span class="n">LIB_DEPS</span> <span class="o">+=</span> <span class="n">util_fir_dec</span>
</pre></div>
</div>
<p>Adding interpolation filters.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="k">set</span><span class="w"> </span>util_fir_int_0<span class="w"> </span><span class="k">[</span><span class="nv">create_bd_cell</span><span class="w"> </span><span class="o">-</span>type<span class="w"> </span>ip<span class="w"> </span><span class="o">-</span>vlnv<span class="w"> </span>analog.com:user:util_fir_int:1.0<span class="w"> </span>util_fir_int_0<span class="k">]</span>
<span class="k">set</span><span class="w"> </span>util_fir_int_1<span class="w"> </span><span class="k">[</span><span class="nv">create_bd_cell</span><span class="w"> </span><span class="o">-</span>type<span class="w"> </span>ip<span class="w"> </span><span class="o">-</span>vlnv<span class="w"> </span>analog.com:user:util_fir_int:1.0<span class="w"> </span>util_fir_int_1<span class="k">]</span>
</pre></div>
</div>
<p>Adding interpolation control.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="k">set</span><span class="w"> </span>interp_slice<span class="w"> </span><span class="k">[</span><span class="nv">create_bd_cell</span><span class="w"> </span><span class="o">-</span>type<span class="w"> </span>inline_hdl<span class="w"> </span><span class="o">-</span>vlnv<span class="w"> </span>xilinx.com:inline_hdl:ilslice:1.0<span class="w"> </span>interp_slice<span class="k">]</span>
</pre></div>
</div>
<p>Adding decimation filters.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="k">set</span><span class="w"> </span>fir_decimator_0<span class="w"> </span><span class="k">[</span><span class="nv">create_bd_cell</span><span class="w"> </span><span class="o">-</span>type<span class="w"> </span>ip<span class="w"> </span><span class="o">-</span>vlnv<span class="w"> </span>analog.com:user:util_fir_dec:1.0<span class="w"> </span>fir_decimator_0<span class="k">]</span>
<span class="k">set</span><span class="w"> </span>fir_decimator_1<span class="w"> </span><span class="k">[</span><span class="nv">create_bd_cell</span><span class="w"> </span><span class="o">-</span>type<span class="w"> </span>ip<span class="w"> </span><span class="o">-</span>vlnv<span class="w"> </span>analog.com:user:util_fir_dec:1.0<span class="w"> </span>fir_decimator_1<span class="k">]</span>
</pre></div>
</div>
<p>Adding decimation control.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="k">set</span><span class="w"> </span>decim_slice<span class="w"> </span><span class="k">[</span><span class="nv">create_bd_cell</span><span class="w"> </span><span class="o">-</span>type<span class="w"> </span>inline_hdl<span class="w"> </span><span class="o">-</span>vlnv<span class="w"> </span>xilinx.com:inline_hdl:ilslice:1.0<span class="w"> </span>decim_slice<span class="k">]</span>
</pre></div>
</div>
<p>The interpolation filter has a 32-bit (I+Q) input data bus. In the base design,
the util_upack2 module is configured to output 4 channels of 16-bit data. By
changing the UPACK number of channels to 2 and the width of the channels to
32-bit, will not work because of how the independent I/Q channel data is
arranged in the 64-bit data bus coming from the DMA; see the figure below:</p>
<a class="reference internal image-reference" href="../../_images/ad9361_dma_data.svg"><img alt="AD9361_DMA_DATA" class="align-center" src="../../_images/ad9361_dma_data.svg" width="1000" /></a>
<p>More information about the util_upack2 core at <a class="reference internal" href="../../library/util_pack/util_upack2.html#util-upack2"><span class="std std-ref">Channel UPACK Utility</span></a>.</p>
<p>As a fact, the data transmitted/received through LVDS interface at DDR (Double
Data Rate) is presented in the diagram below:</p>
<a class="reference internal image-reference" href="../../_images/ad9361_lvds_ddr_transmision.svg"><img alt="ad9361_lvds_ddr_transmision" class="align-center" src="../../_images/ad9361_lvds_ddr_transmision.svg" width="1000" /></a>
<p>At this point, we have two options:</p>
<ol class="arabic simple">
<li><p>Delete the util_ad9361_dac_upack and split the data into some simple slices</p></li>
<li><p>Keep util_ad9361_dac_upack and the possibility to use half of the DMA bandwidth when
one channel is not enabled.</p></li>
</ol>
<p>For this example, the util_ad9361_dac_upack was kept. The core’s proprieties remain
unchanged, and a concatenate module was added, in order to merge the data coming
out from the unpack module, then feed it into the interpolation filter.</p>
<section id="adding-concatenation-modules">
<h3>Adding concatenation modules<a class="headerlink" href="#adding-concatenation-modules" title="Permalink to this heading"></a></h3>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="k">set</span><span class="w"> </span>concat_0<span class="w"> </span><span class="k">[</span><span class="nv">create_bd_cell</span><span class="w"> </span><span class="o">-</span>type<span class="w"> </span>inline_hdl<span class="w"> </span><span class="o">-</span>vlnv<span class="w"> </span>xilinx.com:inline_hdl:ilconcat:1.0<span class="w"> </span>concat_0<span class="k">]</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.IN1_WIDTH.VALUE_SRC<span class="w"> </span>USER<span class="w"> </span>CONFIG.IN0_WIDTH.VALUE_SRC<span class="w"> </span>USER<span class="k">]</span><span class="w"> </span><span class="nv">$concat_0</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.IN0_WIDTH<span class="w"> </span><span class="k">{</span><span class="nv">16</span><span class="k">}</span><span class="w"> </span>CONFIG.IN1_WIDTH<span class="w"> </span><span class="k">{</span><span class="nv">16</span><span class="k">}]</span><span class="w"> </span><span class="nv">$concat_0</span>
<span class="k">set</span><span class="w"> </span>concat_1<span class="w"> </span><span class="k">[</span><span class="nv">create_bd_cell</span><span class="w"> </span><span class="o">-</span>type<span class="w"> </span>inline_hdl<span class="w"> </span><span class="o">-</span>vlnv<span class="w"> </span>xilinx.com:inline_hdl:ilconcat:1.0<span class="w"> </span>concat_1<span class="k">]</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.IN1_WIDTH.VALUE_SRC<span class="w"> </span>USER<span class="w"> </span>CONFIG.IN0_WIDTH.VALUE_SRC<span class="w"> </span>USER<span class="k">]</span><span class="w"> </span><span class="nv">$concat_1</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.IN0_WIDTH<span class="w"> </span><span class="k">{</span><span class="nv">16</span><span class="k">}</span><span class="w"> </span>CONFIG.IN1_WIDTH<span class="w"> </span><span class="k">{</span><span class="nv">16</span><span class="k">}]</span><span class="w"> </span><span class="nv">$concat_1</span>
</pre></div>
</div>
<p>The same principle is applied to the RX path for the pack_core. The difference
is that we need to split the data outputted by the decimation filters to obtain
the independent I/Q channel data.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="k">set</span><span class="w"> </span>pack0_slice_0<span class="w"> </span><span class="k">[</span><span class="nv">create_bd_cell</span><span class="w"> </span><span class="o">-</span>type<span class="w"> </span>inline_hdl<span class="w"> </span><span class="o">-</span>vlnv<span class="w"> </span>xilinx.com:inline_hdl:ilslice:1.0<span class="w"> </span>pack0_slice_0<span class="k">]</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.DIN_FROM<span class="w"> </span><span class="k">{</span><span class="nv">15</span><span class="k">}]</span><span class="w"> </span><span class="nv">$pack0_slice_0</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.DIN_TO<span class="w"> </span><span class="k">{</span><span class="nv">0</span><span class="k">}]</span><span class="w"> </span><span class="nv">$pack0_slice_0</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.DOUT_WIDTH<span class="w"> </span><span class="k">{</span><span class="nv">16</span><span class="k">}]</span><span class="w"> </span><span class="nv">$pack0_slice_0</span>
<span class="k">set</span><span class="w"> </span>pack0_slice_1<span class="w"> </span><span class="k">[</span><span class="nv">create_bd_cell</span><span class="w"> </span><span class="o">-</span>type<span class="w"> </span>inline_hdl<span class="w"> </span><span class="o">-</span>vlnv<span class="w"> </span>xilinx.com:inline_hdl:ilslice:1.0<span class="w"> </span>pack0_slice_1<span class="k">]</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.DIN_FROM<span class="w"> </span><span class="k">{</span><span class="nv">31</span><span class="k">}]</span><span class="w"> </span><span class="nv">$pack0_slice_1</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.DIN_TO<span class="w"> </span><span class="k">{</span><span class="nv">16</span><span class="k">}]</span><span class="w"> </span><span class="nv">$pack0_slice_1</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.DOUT_WIDTH<span class="w"> </span><span class="k">{</span><span class="nv">16</span><span class="k">}]</span><span class="w"> </span><span class="nv">$pack0_slice_1</span>
<span class="k">set</span><span class="w"> </span>pack1_slice_0<span class="w"> </span><span class="k">[</span><span class="nv">create_bd_cell</span><span class="w"> </span><span class="o">-</span>type<span class="w"> </span>inline_hdl<span class="w"> </span><span class="o">-</span>vlnv<span class="w"> </span>xilinx.com:inline_hdl:ilslice:1.0<span class="w"> </span>pack1_slice_0<span class="k">]</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.DIN_FROM<span class="w"> </span><span class="k">{</span><span class="nv">15</span><span class="k">}]</span><span class="w"> </span><span class="nv">$pack1_slice_0</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.DIN_TO<span class="w"> </span><span class="k">{</span><span class="nv">0</span><span class="k">}]</span><span class="w"> </span><span class="nv">$pack1_slice_0</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.DOUT_WIDTH<span class="w"> </span><span class="k">{</span><span class="nv">16</span><span class="k">}]</span><span class="w"> </span><span class="nv">$pack1_slice_0</span>
<span class="k">set</span><span class="w"> </span>pack1_slice_1<span class="w"> </span><span class="k">[</span><span class="nv">create_bd_cell</span><span class="w"> </span><span class="o">-</span>type<span class="w"> </span>inline_hdl<span class="w"> </span><span class="o">-</span>vlnv<span class="w"> </span>xilinx.com:inline_hdl:ilslice:1.0<span class="w"> </span>pack1_slice_1<span class="k">]</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.DIN_FROM<span class="w"> </span><span class="k">{</span><span class="nv">31</span><span class="k">}]</span><span class="w"> </span><span class="nv">$pack1_slice_1</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.DIN_TO<span class="w"> </span><span class="k">{</span><span class="nv">16</span><span class="k">}]</span><span class="w"> </span><span class="nv">$pack1_slice_1</span>
<span class="nv">set_property</span><span class="w"> </span><span class="o">-</span>dict<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span>CONFIG.DOUT_WIDTH<span class="w"> </span><span class="k">{</span><span class="nv">16</span><span class="k">}]</span><span class="w"> </span><span class="nv">$pack1_slice_1</span>
</pre></div>
</div>
</section>
<section id="connecting-the-fir-interpolation-filters-on-the-tx-side">
<h3>Connecting the FIR interpolation filters on the Tx side<a class="headerlink" href="#connecting-the-fir-interpolation-filters-on-the-tx-side" title="Permalink to this heading"></a></h3>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="c"># fir interpolator 0</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_divclk<span class="o">/</span>clk_out<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_0<span class="o">/</span>aclk<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_dac_upack<span class="o">/</span>enable_0<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>axi_ad9361_dac_fifo<span class="o">/</span>din_enable_0<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_dac_upack<span class="o">/</span>enable_1<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>axi_ad9361_dac_fifo<span class="o">/</span>din_enable_1<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_dac_upack<span class="o">/</span>fifo_rd_en<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_0<span class="o">/</span>s_axis_data_tready<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_dac_upack<span class="o">/</span>fifo_rd_en<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_0<span class="o">/</span>s_axis_data_tvalid<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>axi_ad9361_dac_fifo<span class="o">/</span>din_data_0<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_0<span class="o">/</span>channel_0<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>axi_ad9361_dac_fifo<span class="o">/</span>din_data_1<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_0<span class="o">/</span>channel_1<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>axi_ad9361_dac_fifo<span class="o">/</span>din_valid_0<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_0<span class="o">/</span>dac_read<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>concat_0<span class="o">/</span>In0<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_dac_upack<span class="o">/</span>fifo_rd_data_0<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>concat_0<span class="o">/</span>In1<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_dac_upack<span class="o">/</span>fifo_rd_data_1<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>concat_0<span class="o">/</span>dout<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_0<span class="o">/</span>s_axis_data_tdata<span class="k">]</span>

<span class="c"># fir interpolator 1</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_divclk<span class="o">/</span>clk_out<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_1<span class="o">/</span>aclk<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_dac_upack<span class="o">/</span>enable_2<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>axi_ad9361_dac_fifo<span class="o">/</span>din_enable_2<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_dac_upack<span class="o">/</span>enable_3<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>axi_ad9361_dac_fifo<span class="o">/</span>din_enable_3<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_dac_upack<span class="o">/</span>fifo_rd_en<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_1<span class="o">/</span>s_axis_data_tvalid<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>axi_ad9361_dac_fifo<span class="o">/</span>din_data_2<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_1<span class="o">/</span>channel_0<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>axi_ad9361_dac_fifo<span class="o">/</span>din_data_3<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_0<span class="o">/</span>channel_1<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>axi_ad9361_dac_fifo<span class="o">/</span>din_valid_2<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_1<span class="o">/</span>dac_read<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>concat_1<span class="o">/</span>In0<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_dac_upack<span class="o">/</span>fifo_rd_data_2<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>concat_1<span class="o">/</span>In1<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_dac_upack<span class="o">/</span>fifo_rd_data_3<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>concat_1<span class="o">/</span>dout<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_1<span class="o">/</span>s_axis_data_tdata<span class="k">]</span>

<span class="c"># gpio controlled</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>axi_ad9361<span class="o">/</span>up_dac_gpio_out<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>interp_slice<span class="o">/</span>Din<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_0<span class="o">/</span>interpolate<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>interp_slice<span class="o">/</span>Dout<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_fir_int_1<span class="o">/</span>interpolate<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>interp_slice<span class="o">/</span>Dout<span class="k">]</span>
</pre></div>
</div>
<p>In this example, the TX data flow is controlled by the interpolation filter when
interpolation is activated and by the axi_ad9361_core when interpolation is not
active. In the reference design, the data flow is controlled by the ad9631_core.
At this moment, the Interpolation filters are completely integrated into the
design and the data path should look like the one in the figure below.</p>
<a class="reference internal image-reference" href="../../_images/fmcomms2_vivado_interp_fir_tx.jpg"><img alt="FMCOMMS2_VIVADO_INTERP_FIR_TX" class="align-center" src="../../_images/fmcomms2_vivado_interp_fir_tx.jpg" style="width: 1000px;" /></a>
</section>
<section id="connecting-the-fir-decimation-filters-on-the-rx-side">
<h3>Connecting the FIR decimation filters on the Rx side<a class="headerlink" href="#connecting-the-fir-decimation-filters-on-the-rx-side" title="Permalink to this heading"></a></h3>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="c"># fir decimator 0</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_divclk<span class="o">/</span>clk_out<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_0<span class="o">/</span>aclk<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_fifo<span class="o">/</span>dout_data_0<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_0<span class="o">/</span>channel_0<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_fifo<span class="o">/</span>dout_data_1<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_0<span class="o">/</span>channel_1<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_fifo<span class="o">/</span>dout_valid_0<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_0<span class="o">/</span>s_axis_data_tvalid<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_pack<span class="o">/</span>enable_0<span class="w"> </span><span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_fifo<span class="o">/</span>dout_enable_0<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_pack<span class="o">/</span>enable_1<span class="w"> </span><span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_fifo<span class="o">/</span>dout_enable_1<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>pack0_slice_0<span class="o">/</span>Din<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_0<span class="o">/</span>m_axis_data_tdata<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>pack0_slice_1<span class="o">/</span>Din<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_0<span class="o">/</span>m_axis_data_tdata<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_pack<span class="o">/</span>fifo_wr_data_0<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>pack0_slice_0<span class="o">/</span>Dout<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_pack<span class="o">/</span>fifo_wr_data_1<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>pack0_slice_1<span class="o">/</span>Dout<span class="k">]</span>

<span class="c"># fir decimator 1</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_divclk<span class="o">/</span>clk_out<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_1<span class="o">/</span>aclk<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_fifo<span class="o">/</span>dout_data_2<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_1<span class="o">/</span>channel_0<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_fifo<span class="o">/</span>dout_data_3<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_1<span class="o">/</span>channel_1<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_fifo<span class="o">/</span>dout_valid_2<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_1<span class="o">/</span>s_axis_data_tvalid<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_pack<span class="o">/</span>fifo_wr_en<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_1<span class="o">/</span>m_axis_data_tvalid<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_pack<span class="o">/</span>enable_2<span class="w"> </span><span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_fifo<span class="o">/</span>dout_enable_2<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_pack<span class="o">/</span>enable_3<span class="w"> </span><span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_fifo<span class="o">/</span>dout_enable_3<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>pack1_slice_0<span class="o">/</span>Din<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_1<span class="o">/</span>m_axis_data_tdata<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>pack1_slice_1<span class="o">/</span>Din<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_1<span class="o">/</span>m_axis_data_tdata<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_pack<span class="o">/</span>fifo_wr_data_2<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>pack1_slice_0<span class="o">/</span>Dout<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>util_ad9361_adc_pack<span class="o">/</span>fifo_wr_data_3<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>pack1_slice_1<span class="o">/</span>Dout<span class="k">]</span>

<span class="c">#gpio controlled</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>axi_ad9361<span class="o">/</span>up_dac_gpio_out<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>decim_slice<span class="o">/</span>Din<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_0<span class="o">/</span>decimate<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>decim_slice<span class="o">/</span>Dout<span class="k">]</span>
<span class="nv">connect_bd_net</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>fir_decimator_1<span class="o">/</span>decimate<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nv">get_bd_pins</span><span class="w"> </span>decim_slice<span class="o">/</span>Din<span class="k">]</span>
</pre></div>
</div>
</section>
<section id="generating-the-programing-files">
<h3>Generating the programing files<a class="headerlink" href="#generating-the-programing-files" title="Permalink to this heading"></a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>If you did your changes in <strong>GUI</strong>, you can click on <strong>“Generate Bitstream”</strong>.
After the bitstream generation is complete, click on <strong>Files -&gt; Export -&gt;
Export Hardware</strong>, then select <strong>Include Bitstream</strong> option, and the
folder to be saved, should be the <strong>.sdk</strong> folder.</p></li>
<li><p>If you did your changes directly in the <strong>Tcl files</strong>, you can use
<code class="docutils literal notranslate"><span class="pre">make</span></code> to generate the bitstream and .xsa file.</p></li>
<li><p>Now, if your system is based on a <strong>Zynq architecture</strong>, you will have to
generate the <code class="docutils literal notranslate"><span class="pre">BOOT.BIN</span></code>. If you have a <strong>MicroBlaze</strong> soft processor
in your system, booting the Linux will is simpler.</p></li>
</ul>
</div>
<p>More information at:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../user_guide/build_hdl.html#build-hdl"><span class="std std-ref">Build an HDL project</span></a></p></li>
<li><p><a class="icon link reference external" href="https://analogdevicesinc.github.io/documentation/linux/kernel/zynq.html#linux-kernel-zynq" target="_blank" title="(in System Level Documentation)"><span>Build Zynq Linux kernel and devicetree</span></a></p></li>
<li><p><a class="icon link reference external" href="https://analogdevicesinc.github.io/documentation/linux/kernel/microblaze.html#linux-kernel-microblaze" target="_blank" title="(in System Level Documentation)"><span>Build MicroBlaze Linux kernel</span></a></p></li>
</ul>
</section>
</section>
<section id="base-system-functionality">
<h2>Base system functionality<a class="headerlink" href="#base-system-functionality" title="Permalink to this heading"></a></h2>
<p>For simply testing the FMCOMMS2 with filter design, we loop-back the data from
TX to RX for each channel with a SMA to SMA cable.</p>
<a class="reference internal image-reference" href="../../_images/fmcomms2_txrx_loopback.jpg"><img alt="FMCOMMS2_TXRX_LOOPBACK" class="align-center" src="../../_images/fmcomms2_txrx_loopback.jpg" style="width: 1000px;" /></a>
<p>When first booting up the design, none of the filters will be active. For the
beginning, make sure you have the same <strong>LO frequency for RX and TX</strong>, as in the
picture below.</p>
<p>Configure the Transmit/DDS mode to <em>DAC Buffer Output</em>, and chose one of the
<em>.mat</em> files from there and press <em>Load</em>. This will send data in the <em>.mat</em> file
via DMA. This option was chosen because the DDS data does not pass through the
FIR interpolation filters. On the decimation side, data will always pass through
decimation filters.</p>
<p>Below are the settings for FMCOMMS2 and the data plot in FFT and Time Domain for
the “sinewave_0.6.mat”. The file “sinewave_0.6.mat” can be found under the
installation folder, in <strong>liboscwaveforms</strong>. As a functionality example, only
one of the two channels will be enabled.</p>
<p><strong>FFT Domain</strong></p>
<a class="reference internal image-reference" href="../../_images/fmcomms2_fir_setup_activate_dma_data_fft.png"><img alt="FMCOMMS2_FIR_SETUP_ACTIVATE_DMA_DATA_FFT" class="align-center" src="../../_images/fmcomms2_fir_setup_activate_dma_data_fft.png" style="width: 1000px;" /></a>
<p><strong>Time Domain</strong></p>
<a class="reference internal image-reference" href="../../_images/fmcomms2_fir_setup_activate_dma_data_waveform.png"><img alt="FMCOMMS2_FIR_SETUP_ACTIVATE_DMA_DATA_WAVEFORM" class="align-center" src="../../_images/fmcomms2_fir_setup_activate_dma_data_waveform.png" style="width: 1000px;" /></a>
<p>To better understand what is happening with the data inside the FPGA, 3 ILA
(Integrated Logic Analyzer) modules were added in the HDL design.</p>
<p>The 1st ILA was connected to the control signals between the ad9361_core and the
dac_fifo. The 2nd ILA is monitoring the interpolation filters and the 3rd ILA
the decimation filters. As previously discussed above, <strong>none of the filters are
active and only one of the channels is enabled at this point</strong>.</p>
<p><strong>AD9361 core control signals</strong></p>
<a class="reference internal image-reference" href="../../_images/fir_inactive_fifo_ch1_active.png"><img alt="FIR_INACTIVE_FIFO_CH1_ACTIVE" class="align-center" src="../../_images/fir_inactive_fifo_ch1_active.png" style="width: 1000px;" /></a>
<p><strong>Interpolation filters</strong></p>
<a class="reference internal image-reference" href="../../_images/fir_inactive_interpolators_ch1_active.png"><img alt="FIR_INACTIVE_INTERPOLATORS_CH1_ACTIVE" class="align-center" src="../../_images/fir_inactive_interpolators_ch1_active.png" style="width: 1000px;" /></a>
<p><strong>Decimation filters</strong></p>
<a class="reference internal image-reference" href="../../_images/fir_inactive_decimators_ch1_active.png"><img alt="FIR_INACTIVE_DECIMATORS_CH1_ACTIVE" class="align-center" src="../../_images/fir_inactive_decimators_ch1_active.png" style="width: 1000px;" /></a>
</section>
<section id="activating-filters">
<h2>Activating Filters<a class="headerlink" href="#activating-filters" title="Permalink to this heading"></a></h2>
<section id="interpolation-filter">
<h3>Interpolation filter<a class="headerlink" href="#interpolation-filter" title="Permalink to this heading"></a></h3>
<p>In the <a class="reference internal" href="#connecting-the-fir-interpolation-filters-on-the-tx-side">Connecting the FIR interpolation filters on the Tx side</a> section above,
we added a GPIO control. The ad9361_core GPIO control register can be found in
the register map at the address <strong>0xBC</strong> <a class="icon link reference external" href="https://analogdevicesinc.github.io/hdl/library/axi_ad9361/index.html#register-map" target="_blank">AXI AD9361</a>.</p>
<p>To activate the interpolation filter, one must go to the Debug mode:</p>
<ul class="simple">
<li><p>At section Device selection chose <strong>“cf-ad9361-dds-core-lpc”</strong></p></li>
<li><p>In the Register Map settings, select the source to be AXI_CORE</p></li>
<li><p>Read the 0xBC address then write 0x1 value at it, this will activate the
filter.</p></li>
</ul>
<p><strong>Activating TX interpolation filters</strong></p>
<a class="reference internal image-reference" href="../../_images/activate_tx_interpolation_filters_write.png"><img alt="ACTIVATE_TX_INTERPOLATION_FILTERS_WRITE" class="align-center" src="../../_images/activate_tx_interpolation_filters_write.png" style="width: 1000px;" /></a>
<p>After activating the interpolation you can see in FFT domain a 1/8 smaller
fundamental frequency than before (filter interpolation factor is 8).</p>
<a class="reference internal image-reference" href="../../_images/fmcomms2_fir_tx_active_fft.png"><img alt="FMCOMMS2_FIR_TX_ACTIVE_FFT" class="align-center" src="../../_images/fmcomms2_fir_tx_active_fft.png" style="width: 1000px;" /></a>
<p>The data captured by the ILA connected to the interpolation filters shows the
smaller frequency sine wave and the 1/8 valid/clock signals.</p>
<a class="reference internal image-reference" href="../../_images/fir_active_interpolators_all_ch_active.png"><img alt="FIR_ACTIVE_INTERPOLATORS_ALL_CH_ACTIVE" class="align-center" src="../../_images/fir_active_interpolators_all_ch_active.png" style="width: 1000px;" /></a>
</section>
<section id="decimation-filters">
<h3>Decimation filters<a class="headerlink" href="#decimation-filters" title="Permalink to this heading"></a></h3>
<p>At this point, again all filters are disabled.</p>
<p>Similar to interpolation, to activate the decimation we must go to the Debug,
but this time select the “cf-ad9361-lpc”.</p>
<p>Select the “Register Map Settings” source to be “AXI_CORE” and at the same
address <strong>0xBC</strong> <a class="icon link reference external" href="https://analogdevicesinc.github.io/hdl/library/axi_ad9361/index.html#register-map" target="_blank">AXI AD9361</a>. this time being the ADC side GPIO, write 0x1, as
in the example below:</p>
<a class="reference internal image-reference" href="../../_images/activate_rx_interpolation_filters_write.png"><img alt="ACTIVATE_RX_INTERPOLATION_FILTERS_WRITE" class="align-center" src="../../_images/activate_rx_interpolation_filters_write.png" style="width: 1000px;" /></a>
<p>You will see in the FFT domain, a frequency 8 times bigger than the one when the
filters were inactive (decimation factor is 8):</p>
<a class="reference internal image-reference" href="../../_images/fmcomms2_fir_rx_active_fft.png"><img alt="ACTIVATE_RX_INTERPOLATION_FILTERS_WRITE" class="align-center" src="../../_images/fmcomms2_fir_rx_active_fft.png" style="width: 1000px;" /></a>
<p>The signals captured by the ILA:</p>
<a class="reference internal image-reference" href="../../_images/fir_inactive_decimators_ch1_active_int_activ.png"><img alt="FIR_INACTIVE_DECIMATORS_CH1_ACTIVE_INT_ACTIV" class="align-center" src="../../_images/fir_inactive_decimators_ch1_active_int_activ.png" style="width: 1000px;" /></a>
</section>
<section id="all-filters-active-characteristic">
<h3>All filters active characteristic<a class="headerlink" href="#all-filters-active-characteristic" title="Permalink to this heading"></a></h3>
<p><strong>FFT characteristic</strong></p>
<a class="reference internal image-reference" href="../../_images/fmcomms2_fir_tx_rx_active_fft.png"><img alt="FMCOMMS_FIR_TX_RX_ACTIVE_FFT" class="align-center" src="../../_images/fmcomms2_fir_tx_rx_active_fft.png" style="width: 1000px;" /></a>
<p><strong>Time Domain characteristic</strong></p>
<a class="reference internal image-reference" href="../../_images/fmcomms2_fir_tx_rx_active_waveform.png"><img alt="FMCOMMS_FIR_TX_RX_ACTIVE_WAVEFORM" class="align-center" src="../../_images/fmcomms2_fir_tx_rx_active_waveform.png" style="width: 1000px;" /></a>
</section>
</section>
<section id="older-sources">
<h2>Older sources<a class="headerlink" href="#older-sources" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Sources from older examples can be found under the tag
<a class="icon link reference external" href="https://github.com/analogdevicesinc/hdl/releases/tag/eg_fmcomms2_fir_filter" target="_blank">eg_fmcomms2_fir_filter</a> using Vivado 16.2 and 16.4 versions, and
<strong>are not supported by us anymore</strong>.</p></li>
</ul>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><a class="icon link reference external" href="https://uk.mathworks.com/help/dsp/ref/fdesign.interpolator.html" target="_blank">MathWorks Interpolator</a></p></li>
<li><p><a class="reference internal" href="../../library/axi_ad9361/index.html#axi-ad9361"><span class="std std-ref">AXI AD9361</span></a></p></li>
<li><p><a class="reference internal" href="../../user_guide/build_hdl.html#build-hdl"><span class="std std-ref">Build an HDL project</span></a></p></li>
<li><p><a class="reference internal" href="index.html#fmcomms2"><span class="std std-ref">FMCOMMS2/3/4 HDL Project</span></a></p></li>
<li><p><a class="reference internal" href="../../library/util_pack/util_upack2.html#util-upack2"><span class="std std-ref">Channel UPACK Utility</span></a></p></li>
<li><p><a class="reference internal" href="../../library/util_pack/util_cpack2.html#util-cpack2"><span class="std std-ref">Channel CPACK Utility</span></a></p></li>
</ul>
</section>
</section>


          </div>
              <div class="related">
                &nbsp;
    <a href="index.html" title="Previous document (Alt+Shift+LeftArrow)" class="prev">FMCOMMS2/3/4 HDL Project</a>
    <a href="../fmcomms5/index.html" title="Next document (Alt+Shift+RightArrow)" class="next">FMCOMMS5 HDL Project</a>
              </div>
          
        </div>
      </div>
  </div>

  <label id="cancel-area-show-toc" for="input-show-toc"></label>
  <label id="cancel-area-show-localtoc" for="input-show-localtoc"></label>
    <footer>
      &#169;2023-2025, Analog Devices, Inc.
      
      |
      Made with <a href="https://www.sphinx-doc.org/">Sphinx</a>
      &amp; <a href="https://github.com/analogdevicesinc/doctools">Doctools</a>
      
    </footer>
  </body>
</html>