<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Control Interface &#8212; HDL  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8e8a900e" />
    <link rel="stylesheet" type="text/css" href="../../_static/app.min.css?v=47649d88" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <script defer="" src="../../_static/app.umd.js?v=9e881883"></script>
    <link rel="icon" href="../../_static/icon.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="JESD204 Interface Framework" href="../jesd204/index.html" />
    <link rel="prev" title="I3C Controller Core" href="i3c_controller_core.html" />
   
  
  <meta name="repository" content="hdl">
  <meta name="version" content="">
  


<style>
  body {
    
  }

  body.dark {
    
  }

  @media (prefers-color-scheme: dark) {
    body:not(.light) {
      
    }
  }
</style>
  </head><body>
  <input type="checkbox" id="input-show-toc">
  <input type="checkbox" id="input-show-localtoc">
  <input type="checkbox" id="input-show-repotoc">

  
  <div class="search-area">
    <form action="" method="get">
      <input type="text" name="q" aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="search" placeholder="Search"/>
      <button class="icon"></button>
    </form>
  </div>
  

  <header>
    <div id="left">
      <label id="show-sidebar" class="icon" for="input-show-toc" title="Show/hide index"></label>
    </div>
    <div id="right">
      <span>
        <a id="logo-org" href="https://analog.com"></a>
        <div class="vertical-divider"></div>
        <label id="show-repotoc" for="input-show-repotoc" title="Show/hide docs" tabindex="0">Docs</label>
        <a id="logo" href="../../index.html">
          <div>HDL</div>
        </a>
      </span>
      <span class="reverse">
        <label id="show-localtoc" class="icon" for="input-show-localtoc" title="Show/hide contents"></label>
      </span>
    </div>
  </header>


  <div class="repotoc-tree overlay">
    <root>
  <a href="../../index.html" class="current">HDL</a>
</root>

  </div>
    <div class="localtoc">
      <div class="tocwrapper">
        <div>
          <div class="localtoc-header"></div>
          <a id="scroll-up" href="#top-anchor" title="Back to top"></a>
        </div>
        <nav>
          <ul>
<li><a class="reference internal" href="#">Control Interface</a><ul>
<li><a class="reference internal" href="#instruction-set-specification">Instruction Set Specification</a><ul>
<li><a class="reference internal" href="#command-descriptors">Command Descriptors</a><ul>
<li><a class="reference internal" href="#ccc-instruction">CCC Instruction</a></li>
<li><a class="reference internal" href="#private-transfer">Private Transfer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#command-receipts">Command Receipts</a><ul>
<li><a class="reference internal" href="#error-codes">Error codes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#in-band-interrupts">In-Band Interrupts</a></li>
<li><a class="reference internal" href="#sdi-and-sdo">SDI and SDO</a></li>
<li><a class="reference internal" href="#dynamic-address-assignment">Dynamic Address Assignment</a></li>
<li><a class="reference internal" href="#word-command-interface">Word Command Interface</a></li>
<li><a class="reference internal" href="#configuration-registers">Configuration Registers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#offload-interface">Offload Interface</a></li>
<li><a class="reference internal" href="#the-block-ram-offload">The Block RAM Offload</a></li>
<li><a class="reference internal" href="#debugging-tips">Debugging Tips</a></li>
</ul>
</li>
</ul>

        </nav>
      </div>
    </div>

  
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
    <a id="logo" href="../../index.html">
      <img class="only-light" src="../../_static/HDL_logo_cropped.svg"/>
      <img class="only-dark" src="../../_static/HDL_logo_w_cropped.svg"/>
    </a><input id="input-switch-toc" type="checkbox">
<label id="show-repotoc" for="input-switch-toc">
All content
</label>
<label id="show-toc" for="input-switch-toc">
Content on this topic
</label>
<div class="repotoc-tree">
  <root>
  <a href="../../index.html" class="current">HDL</a>
</root>

</div>
<div class="toc-tree">
  <html>
  <body><ul>
<li class="toctree-l1"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-1" id="toctree-collapse-1"/><div class="collapse"><a class="reference internal" href="../../user_guide/index.html">User Guide</a><label for="toctree-collapse-1"><div class="icon"></div></label></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/git_repository.html">Git repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/releases.html">Releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/build_hdl.html">Build an HDL project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/build_boot_bin.html">Build the BOOT.BIN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/build_intel_boot_image.html">Build the Intel Boot Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/architecture.html">HDL architecture</a></li>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-1-1" id="toctree-collapse-1-1"/><div class="collapse"><a class="reference internal" href="../../user_guide/ip_cores/index.html">IP cores</a><label for="toctree-collapse-1-1"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/ip_cores/creating_new_ip.html">Creating a new IP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/ip_cores/use_adi_ips.html">Use ADI IPs into your own project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/ip_cores/interfaces.html">Interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/ip_cores/axi_adc/index.html">Generic AXI ADC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/ip_cores/axi_dac/index.html">Generic AXI DAC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/porting_project.html">Porting HDL projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/customize_hdl.html">Customize HDL projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hdl_coding_guidelines.html">HDL coding guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/docs_guidelines.html">Documentation guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/contributing.html">Contributing to HDL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/third_party.html">Third party forks</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2" id="toctree-collapse-2" checked=""/><div class="collapse"><a class="reference internal" href="../index.html">IP Cores</a><label for="toctree-collapse-2"><div class="icon"></div></label></div><ul class="current">
<li class="toctree-l2 current"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-1" id="toctree-collapse-2-1" checked=""/><div class="collapse"><a class="reference internal" href="index.html">I3C Controller</a><label for="toctree-collapse-2-1"><div class="icon"></div></label></div><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="i3c_controller_host_interface.html">Host Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="i3c_controller_core.html">Core Module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Interface</a></li>
</ul>
</li>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-2" id="toctree-collapse-2-2"/><div class="collapse"><a class="reference internal" href="../jesd204/index.html">JESD204 Interface Framework</a><label for="toctree-collapse-2-2"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../jesd204/axi_jesd204_tx/index.html">JESD204B/C Link Transmit Peripheral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../jesd204/axi_jesd204_rx/index.html">JESD204B/C Link Receive Peripheral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../jesd204/ad_ip_jesd204_tpl_adc/index.html">ADC JESD204B/C Transport Peripheral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../jesd204/ad_ip_jesd204_tpl_dac/index.html">DAC JESD204B/C Transport Peripheral</a></li>
</ul>
</li>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-3" id="toctree-collapse-2-3"/><div class="collapse"><a class="reference internal" href="../spi_engine/index.html">SPI Engine</a><label for="toctree-collapse-2-3"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../spi_engine/spi_engine_execution.html">Execution Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi_engine/axi_spi_engine.html">AXI Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi_engine/spi_engine_offload.html">Offload Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi_engine/spi_engine_interconnect.html">Interconnect Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi_engine/control-interface.html">Control Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi_engine/offload-control-interface.html">Offload Control Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi_engine/spi-bus-interface.html">SPI Bus Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi_engine/instruction-format.html">Instruction Set Specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi_engine/pipeline-delays.html">Pipeline Delays</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi_engine/tutorial.html">Tutorial - PulSAR ADC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad35xxr/index.html">AXI AD35XXR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad408x/index.html">AXI AD408x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad485x/index.html">AXI AD485x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad7405/index.html">AXI AD7405</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad7606x/index.html">AXI AD7606x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad7616/index.html">AXI AD7616</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad7768/index.html">AXI AD7768</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad777x/index.html">AXI AD777x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad9265/index.html">AXI AD9265</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad9361/index.html">AXI AD9361</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad9467/index.html">AXI AD9467</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad9783/index.html">AXI AD9783</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad9963/index.html">AXI AD9963</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ada4355/index.html">AXI ADA4355</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_adaq8092/index.html">AXI ADAQ8092</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_adrv9001/index.html">AXI ADRV9001</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ltc235x/index.html">AXI LTC235X</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ltc2387/index.html">AXI LTC2387</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_offload/index.html">Data Offload</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_dmac/index.html">AXI DMAC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_hdmi_rx/index.html">AXI HDMI RX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_hdmi_tx/index.html">AXI HDMI TX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_adc_decimate/index.html">AXI ADC Decimate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_adc_trigger/index.html">AXI ADC Trigger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_adxcvr/index.html">AXI ADXCVR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_clkgen/index.html">AXI CLK Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_clock_monitor/index.html">AXI Clock Monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_dac_interpolate/index.html">AXI DAC Interpolate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_fan_control/index.html">AXI Fan Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_laser_driver/index.html">AXI Laser Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_logic_analyzer/index.html">AXI Logic Analyzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_pwm_gen/index.html">AXI PWM Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_sysid/index.html">AXI System ID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_tdd/index.html">AXI TDD</a></li>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-4" id="toctree-collapse-2-4"/><div class="collapse"><a class="reference internal" href="../cn0363/index.html">CN0363</a><label for="toctree-collapse-2-4"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../cn0363/cn0363_dma_sequencer.html">CN0363 DMA Sequencer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cn0363/cn0363_phase_data_sync.html">CN0363 Phase Data Sync</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../common/ad_dds/index.html">AD Direct Digital Synthesis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../corundum/index.html">Corundum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util_axis_fifo/index.html">AXI Stream FIFO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util_axis_fifo_asym/index.html">Asymmetric AXI Stream FIFO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util_extract/index.html">Util Extract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util_mii_to_rmii/index.html">Util MII to RMII</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util_pack/util_cpack2.html">Channel CPACK Utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util_pack/util_upack2.html">Channel UPACK Utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util_rfifo/index.html">Util RFIFO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util_sigma_delta_spi/index.html">Util Sigma Delta SPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util_var_fifo/index.html">Util VAR FIFO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util_wfifo/index.html">Util WFIFO</a></li>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-5" id="toctree-collapse-2-5"/><div class="collapse"><a class="reference internal" href="../xilinx/index.html">AMD Xilinx Specific IPs</a><label for="toctree-collapse-2-5"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../xilinx/util_adxcvr/index.html">UTIL_ADXCVR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad9144/index.html">AXI AD9144 (OBSOLETE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad9371/index.html">AXI AD9371 (OBSOLETE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad9643/index.html">AXI AD9643 (OBSOLETE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../axi_ad9671/index.html">AXI AD9671 (OBSOLETE)</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-3" id="toctree-collapse-3"/><div class="collapse"><a class="reference internal" href="../../projects/index.html">Projects</a><label for="toctree-collapse-3"><div class="icon"></div></label></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad_gmsl2eth_sl/index.html">AD-GMSL2ETH-SL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad_quadmxfe1_ebz/index.html">AD-QUADMXFE1-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad353xr/index.html">AD353XR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad35xxr_evb/index.html">AD35XXR-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad4052_ardz/index.html">AD4052-ARDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad408x_fmc_evb/index.html">AD408X-FMC-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad4110/index.html">AD4110-SDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad411x_ad717x/index.html">AD411x-AD717x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad4134_fmc/index.html">AD4134-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad4170_asdz/index.html">AD4170-ASDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad4630_fmc/index.html">AD4630-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad469x_evb/index.html">AD469X-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad485x_fmcz/index.html">AD485X-FMCZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad5758_sdz/index.html">AD5758-SDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad5766_sdz/index.html">AD5766-SDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad57xx_ardz/index.html">AD57XX-ARDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad6676evb/index.html">AD6676EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad7124_asdz/index.html">AD7124-ASDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad7134_fmc/index.html">AD7134-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad719x_asdz/index.html">AD719X-ASDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad738x_fmc/index.html">AD738X-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad7405_fmc/index.html">AD7405-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad7606x_fmc/index.html">AD7606X-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad7616_sdz/index.html">AD7616-SDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad77681evb/index.html">AD7768-1-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad7768evb/index.html">AD7768-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad777x_ardz/index.html">AD777X-ARDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9081_fmca_ebz/index.html">AD9081-FMCA-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9081_fmca_ebz_x_band/index.html">AD9081-FMCA-EBZ-X-BAND</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9083_evb/index.html">AD9083-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9208_dual_ebz/index.html">AD9208-DUAL-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9209_fmca_ebz/index.html">AD9209-FMCA-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9213_dual_ebz/index.html">AD9213-DUAL-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9213_evb/index.html">AD9213-EVB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9265_fmc/index.html">AD9265-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9434_fmc/index.html">AD9434-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9467_fmc/index.html">AD9467-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9656_fmc/index.html">AD9656-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9694_fmc/index.html">AD9694-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9695_fmc/index.html">AD9695-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9783_ebz/index.html">AD9783-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ada4355_fmc/index.html">ADA4355-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/adaq7980_sdz/index.html">ADAQ7980-SDZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/adaq8092_fmc/index.html">ADAQ8092-FMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/adrv9001/index.html">ADRV9001</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/adrv9001_dual/index.html">ADRV9001-DUAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/adrv9009/index.html">ADRV9009</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/adrv9009zu11eg/index.html">ADRV9009-ZU11EG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/adrv9026/index.html">ADRV9026</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/adrv904x/index.html">ADRV904x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/adrv9361z7035/index.html">ADRV9361Z7035</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/adrv9364z7020/index.html">ADRV9364Z7020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/adrv9371x/index.html">ADRV9371x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/adv7511/index.html">ADV7511</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/adv7513/index.html">ADV7513</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/arradio/index.html">ARRADIO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/cn0363/index.html">CN0363</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/cn0506/index.html">CN0506</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/cn0540/index.html">CN0540</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/cn0561/index.html">CN0561</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/cn0577/index.html">CN0577</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/cn0579/index.html">CN0579</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/cn0585/index.html">CN0585</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/dac_fmc_ebz/index.html">DAC-FMC-EBZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/dc2677a/index.html">DC2677A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/fmcomms2/index.html">FMCOMMS2/3/4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/fmcomms5/index.html">FMCOMMS5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/fmcomms8/index.html">FMCOMMS8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/fmcomms11/index.html">FMCOMMS11</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/jupiter_sdr/index.html">JUPITER-SDR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/m2k/index.html">M2K</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/max96724/index.html">MAX96724</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/pluto/index.html">PLUTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/pulsar_adc/index.html">PULSAR-ADC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/pulsar_lvds_adc/index.html">PULSAR-LVDS-ADC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad9739a_fmc/index.html">AD9739A-FMC (OBSOLETE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/ad_fmclidar1_ebz/index.html">AD-FMCLIDAR1-EBZ (OBSOLETE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/fmcadc2/index.html">FMCADC2 (OBSOLETE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/fmcadc5/index.html">FMCADC5 (OBSOLETE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/fmcjesdadc1/index.html">FMCJESDADC1 (OBSOLETE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/imageon/index.html">IMAGEON (OBSOLETE)</a></li>
</ul>
</li>
</ul>
</body>
</html>

</div>
        </div>
      </div>

  <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper" id="top-anchor">
          <div class="body-header">
    <nav class="breadcrumb">
        <ol>
          <li><a href="../index.html">IP Cores</a></li>
          <li><a href="index.html">I3C Controller</a></li>
          </ol>
    </nav>
  </div>

          <div class="body" role="main">
            
  <section id="control-interface">
<span id="i3c-controller-control-interface"></span><h1>Control Interface<a class="headerlink" href="#control-interface" title="Permalink to this heading"></a></h1>
<p>The control interface exchanges data between the cores within the I3C Controller.</p>
<p>The interface consists of five streams:</p>
<ul class="simple">
<li><p>cmd: carries instructions on what procedures the I3C Controller should execute.</p></li>
<li><p>cmdr: carries synchronization events and metadata from sent instructions.</p></li>
<li><p>sdo: carries data to be transmitted in the I3C bus.</p></li>
<li><p>sdi: carries data received from the I3C bus during a CCC or private transfer.</p></li>
<li><p>ibi: carries data received from the I3C bus during an IBI.</p></li>
</ul>
<section id="instruction-set-specification">
<span id="i3c-controller-instruction-format"></span><h2>Instruction Set Specification<a class="headerlink" href="#instruction-set-specification" title="Permalink to this heading"></a></h2>
<p>The I3C Controller instruction set is a pair of 32-bit command descriptors
(command 0 and command 1), with the latter present only for some command 0 values.</p>
<section id="command-descriptors">
<span id="i3c-controller-command-descriptors"></span><h3>Command Descriptors<a class="headerlink" href="#command-descriptors" title="Permalink to this heading"></a></h3>
<p>The generic structure of command 0 is:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="3"><p>Command 0</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Name</p></th>
<th class="head"><p>Range</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td></td>
<td><p>31:23</p></td>
<td><p>Reserved.</p></td>
</tr>
<tr class="row-even"><td><p>Is CCC</p></td>
<td><p>22</p></td>
<td><p>Indicate if it is a CCC transfer (1) or not (0).</p></td>
</tr>
<tr class="row-odd"><td><p>Bcast.
header</p></td>
<td><p>21</p></td>
<td><p>Include broadcast header in private transfer (1)
or not (0).</p></td>
</tr>
<tr class="row-even"><td><p>Sr</p></td>
<td><p>20</p></td>
<td><p>Repeated start flag, yield a Sr (1) or P (0)
at the end of the transfer.</p></td>
</tr>
<tr class="row-odd"><td><p>Buffer
lenght</p></td>
<td><p>19:8</p></td>
<td><p>Unsigned 12-bits payload length, direction
depends on RNW value.</p></td>
</tr>
<tr class="row-even"><td><p>DA</p></td>
<td><p>7:1</p></td>
<td><p>7-bit device address (don’t care in broadcast
mode).</p></td>
</tr>
<tr class="row-odd"><td><p>RNW</p></td>
<td><p>0:0</p></td>
<td><p>If should retrieve data from device (1) or not
(0).</p></td>
</tr>
</tbody>
</table>
</div>
<p>The Sr flag will be ignored if the next Command Descriptor is available at the
correct clock cycle.
Also, the software must ensure the next Command Descriptor is from the same branch
of the state machine, for example, cannot jump from a Private Transfer to a
Broadcast CCC, must always return to Start (Sr=0).
For a flowchart of the those paths, see Fig. 168, p.387 from MIPI I3C
specification<a class="footnote-reference brackets" href="#f1" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
<p>The structure of command 1 depends on command 0 first bits and are defined in
the following subsections.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CCC always broadcast header after a bus available, therefore “Bcast. header”
is ignored for CCCs.</p>
</div>
<section id="ccc-instruction">
<span id="i3c-controller-ccc"></span><h4>CCC Instruction<a class="headerlink" href="#ccc-instruction" title="Permalink to this heading"></a></h4>
<p>Sent with <code class="code docutils literal notranslate"><span class="pre">adi_i3c_controller_send_ccc_cmd</span></code>, it does a CCC transfer.
The CCC ID is defined in the <em>linux/i3c/ccc.h</em> file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Controller enters the DAA procedure with the ENTDAA CCC
instruction and exits when its the hardware state machine sequence finishes.
For the ENTDAA CCC buffer length should be 0, even though DAs are sent during
the procedure.</p>
</div>
<p>Bits not presented in the tables are assumed 0.
When Value is filled, it means it is the required constant value for this
transfer.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="4"><p>Command 0, CCC instruction</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Name</p></th>
<th class="head"><p>Range</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>Is CCC</p></td>
<td><p>22</p></td>
<td><p>1</p></td>
<td><p>CCC transfer type.</p></td>
</tr>
<tr class="row-even"><td><p>Sr</p></td>
<td><p>20</p></td>
<td></td>
<td><p>Repeated start flag, yield a Sr (1) or P (0)
at the end of the transfer.</p></td>
</tr>
<tr class="row-odd"><td><p>Buffer
length</p></td>
<td><p>19:8</p></td>
<td></td>
<td><p>Unsigned 12-bits payload length, direction
depends on RNW value.</p></td>
</tr>
<tr class="row-even"><td><p>DA</p></td>
<td><p>7:1</p></td>
<td></td>
<td><p>7-bit device address (don’t care in broadcast
mode).</p></td>
</tr>
<tr class="row-odd"><td><p>RNW</p></td>
<td><p>0:0</p></td>
<td></td>
<td><ol class="arabic simple">
<li><p>sets the payload buffer as rx and (0) as tx.</p></li>
</ol>
</td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="4"><p>Command 1, CCC instruction</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Name</p></th>
<th class="head"><p>Range</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>Type</p></td>
<td><p>7</p></td>
<td></td>
<td><p>Direct (1) or broadcast (0), except SETXTIME
and VENDOR.</p></td>
</tr>
<tr class="row-even"><td><p>ID</p></td>
<td><p>6:0</p></td>
<td></td>
<td><p>CCC to transfer, is the same content as the
payload to be sent in the bus.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="private-transfer">
<h4>Private Transfer<a class="headerlink" href="#private-transfer" title="Permalink to this heading"></a></h4>
<p>Sent with <code class="code docutils literal notranslate"><span class="pre">adi_i3c_controller_priv_xfers</span></code>, it does a private transfer.</p>
<p>Bits not presented in the tables are assumed 0.
When Value is filled, it means it is is the required constant value for this
transfer.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="4"><p>Command 0, private instruction</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Name</p></th>
<th class="head"><p>Range</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>Is CCC</p></td>
<td><p>22</p></td>
<td><p>0</p></td>
<td><p>Not a CCC transfer type.</p></td>
</tr>
<tr class="row-even"><td><p>Broad.
header</p></td>
<td><p>21</p></td>
<td></td>
<td><p>Include broadcast header in private transfer (1)
or not (0).</p></td>
</tr>
<tr class="row-odd"><td><p>Sr</p></td>
<td><p>20</p></td>
<td></td>
<td><p>Repeated start flag, yield a Sr (1) or P (0)
at the end of the transfer.</p></td>
</tr>
<tr class="row-even"><td><p>Buffer
lenght</p></td>
<td><p>19:8</p></td>
<td></td>
<td><p>Unsigned 12-bits payload length, direction
depends on RNW value.</p></td>
</tr>
<tr class="row-odd"><td><p>DA</p></td>
<td><p>7:1</p></td>
<td></td>
<td><p>7-bit device address (don’t care in broadcast
mode).</p></td>
</tr>
<tr class="row-even"><td><p>RNW</p></td>
<td><p>0:0</p></td>
<td></td>
<td><ol class="arabic simple">
<li><p>sets the payload buffer as rx and (0) as tx.</p></li>
</ol>
</td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="4"><p>Command 1, private instruction (unused)</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Name</p></th>
<th class="head"><p>Range</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="command-receipts">
<span id="i3c-controller-cmdr"></span><h3>Command Receipts<a class="headerlink" href="#command-receipts" title="Permalink to this heading"></a></h3>
<p>Command receipts (cmdr) are returned descriptors for each command descriptor
executed (cmd).
When a new cmdr is written to the CMDR FIFO, an interrupton is sent to
PS, see <a class="reference internal" href="i3c_controller_host_interface.html#i3c-controller-interrupts"><span class="std std-ref">Interrupts</span></a>.</p>
<p>In the cmdr, the buffer length is updated with the number of bytes actually
transferred.
For sending to the peripheral (RNW=0), it will be either 0, when the peripheral
does not ACK the address, or the original buffer length, since the peripheral
cannot stop the transfer in the middle, as it can during a rx transfer (RNW=1).</p>
<p>The structure of the command receipt is:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="3"><p>Command receipt</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Name</p></th>
<th class="head"><p>Range</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td></td>
<td><p>31:24</p></td>
<td><p>Reserved.</p></td>
</tr>
<tr class="row-even"><td><p>Error</p></td>
<td><p>23:20</p></td>
<td><p>If an error occurred during the transfer.</p></td>
</tr>
<tr class="row-odd"><td><p>Buffer
length</p></td>
<td><p>19:8</p></td>
<td><p>Unsigned 12-bits transferred payload length.</p></td>
</tr>
<tr class="row-even"><td><p>Sync</p></td>
<td><p>7:0</p></td>
<td><p>Command synchronization.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The Sync is a synchronization identifier that increases (then returns to 0)
at each transfer.</p>
<section id="error-codes">
<h4>Error codes<a class="headerlink" href="#error-codes" title="Permalink to this heading"></a></h4>
<p>The error codes are:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="3"><p>Command receipt error codes</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Code</p></th>
<th class="head"><p>ID</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>0</p></td>
<td><p>NO_ERROR</p></td>
<td><p>No error.</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>CE0_ERROR</p></td>
<td><p>Illegally formatted CCC.</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>CE2_ERROR</p></td>
<td><p>No response to broadcast address.</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>NACK_RESP</p></td>
<td><p>The peripheral did not ACK the transfer.</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>UDA_ERROR</p></td>
<td><p>DA in CMD instruction or IBI is unknown.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The C0-3 errors are defined by the I3C specification.
The CE0 occurs when an unexpected number of bytes are received by the controller
during in a CCC.
The CE1 and CE3 never occurs in the implementation.
CE2 and NACK_RESP are very similar, but CE2 is restricted for the first ACK of
a transfer, when the controller sends the broadcast address 7’h7e.</p>
<p>On software, check bit:</p>
<ul class="simple">
<li><p>3: for any NACK response.</p></li>
<li><p>4: for unknown address.</p></li>
</ul>
</section>
</section>
<section id="in-band-interrupts">
<span id="i3c-controller-ibi"></span><h3>In-Band Interrupts<a class="headerlink" href="#in-band-interrupts" title="Permalink to this heading"></a></h3>
<p>IBI’s are resolved autonomously during bus available per specification,
if they are accepted or rejected depends if the feature itself is enabled;
see I3C Controller’s <a class="reference internal" href="i3c_controller_host_interface.html#i3c-controller-regmap"><span class="std std-ref">Register Map</span></a> register <code class="docutils literal notranslate"><span class="pre">IBI_CONFIG</span></code> for
more info.
The accepted IBI’s fill the IBI FIFO and generate an interrupt to the
PS.</p>
<p>The structure of the received IBI is:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="3"><p>In-band interrupt</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Name</p></th>
<th class="head"><p>Range</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td></td>
<td><p>31:23</p></td>
<td><p>Reserved.</p></td>
</tr>
<tr class="row-even"><td><p>DA</p></td>
<td><p>23:17</p></td>
<td><p>Dynamic address.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>16</p></td>
<td><p>Reserved.</p></td>
</tr>
<tr class="row-even"><td><p>MDB</p></td>
<td><p>15:8</p></td>
<td><p>Mandatory data byte.</p></td>
</tr>
<tr class="row-odd"><td><p>Sync</p></td>
<td><p>7:0</p></td>
<td><p>IBI synchronization.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Additional bytes are not supported.</p>
</div>
<p>The software interprets the mandatory data bytes, some by the I3C controller
driver and some by the peripheral driver.
The MIPI pre-defines and reserves some values for the MDB,
which are kept updated at the I3C MDB Values implementers table<a class="footnote-reference brackets" href="#f0" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<p>There is two configurations for the IBI, to enable accepting IBIs
and listen to peripheral IBI requests.</p>
<p>If IBI is disabled, the controller will NACK IBI requests.
If enabled, the controller will ACK the IBI request and receive the
MDB.
In both cases, the controller will proceed with the cmd transfer after resolving
the IBI request (since the request occur during the header broadcast).</p>
</section>
<section id="sdi-and-sdo">
<h3>SDI and SDO<a class="headerlink" href="#sdi-and-sdo" title="Permalink to this heading"></a></h3>
<p>During the serialization of the 32-bits FIFOs into 1-byte packages,
if the command descriptor describes a payload of length 5, the controller will
send the 4 bytes of the element at the top of SDO FIFO’s stack, then the
left-most byte of the next SDO FIFO’s element.</p>
<p>For example, consider the following data:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">u32</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">0x78563412</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFE</span><span class="p">};</span>
</pre></div>
</div>
<p>The table below exemplifies the sequence (“D” is discarded):</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="5"><p>Payload transfer, length = 5</p></th>
</tr>
<tr class="row-even"><th class="head"><p>SDO FIFO Stack</p></th>
<th class="head"><p>Byte3</p></th>
<th class="head"><p>Byte2</p></th>
<th class="head"><p>Byte1</p></th>
<th class="head"><p>Byte0</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>#0</p></td>
<td><p>0x78</p></td>
<td><p>0x56</p></td>
<td><p>0x34</p></td>
<td><p>0x12</p></td>
</tr>
<tr class="row-even"><td><p>#1</p></td>
<td><p>D</p></td>
<td><p>D</p></td>
<td><p>D</p></td>
<td><p>0xFE</p></td>
</tr>
</tbody>
</table>
</div>
<p>For the SDI FIFO, considering the I3C bus sends the most significant byte first,
a transfer of 6 bytes would fill the SDI FIFO as follows:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="5"><p>Payload transfer, length = 5</p></th>
</tr>
<tr class="row-even"><th class="head"><p>SD1 FIFO Stack</p></th>
<th class="head"><p>Byte3</p></th>
<th class="head"><p>Byte2</p></th>
<th class="head"><p>Byte1</p></th>
<th class="head"><p>Byte0</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>#0</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>#1</p></td>
<td><p>4</p></td>
<td><p>D</p></td>
<td><p>D</p></td>
<td><p>D</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="dynamic-address-assignment">
<span id="i3c-controller-daa"></span><h3>Dynamic Address Assignment<a class="headerlink" href="#dynamic-address-assignment" title="Permalink to this heading"></a></h3>
<p>The Dynamic Address Assignment (DAA) is a procedure that is entered through the
ENTDAA CCC, see <a class="reference internal" href="#i3c-controller-ccc"><span class="std std-ref">CCC Instruction</span></a> for the instruction itself.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The <code class="docutils literal notranslate"><span class="pre">SDO</span></code> FIFO <strong>must</strong> be empty before entering the DAA.</p>
</div>
<p>During the DAA, after a peripheral acknowledges the procedure and sends its
PID, BCR, and DCR, the controller triggers the <code class="docutils literal notranslate"><span class="pre">DAA_PENDING</span></code> interrupt,
requesting a Dynamic Address (DA).
The software reads twice the SDI FIFO to acquire the PID, BCR and DCR (optional),
and writes a DA with T-bit to the MSB of SDO FIFO:</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">6</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">da</span><span class="p">;</span>
<span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">sdo</span><span class="p">;</span>
<span class="n">sdo</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="p">{</span><span class="n">da</span><span class="p">,</span><span class="w"> </span><span class="o">~^</span><span class="n">da</span><span class="p">,</span><span class="w"> </span><span class="mh">24</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="c1">// DA + T-bit + don&#39;t care</span>
</pre></div>
</div>
<p>Then, it clears the <code class="docutils literal notranslate"><span class="pre">PENDING_DAA</span></code> interrupt (see <a class="reference internal" href="i3c_controller_host_interface.html#i3c-controller-interrupts"><span class="std std-ref">Interrupts</span></a>).</p>
<p>The controller repeats the procedure for every device that requests an address
during the DAA, and also the software resolves every subsequent interrupt.</p>
<p>The read of the SDI FIFO is optional because the software can either:</p>
<ul class="simple">
<li><p>Seek the desired DA using the received PID.</p></li>
<li><p>Assign another DA using the <code class="docutils literal notranslate"><span class="pre">GETPID</span></code> and <code class="docutils literal notranslate"><span class="pre">SETNEWDA</span></code> CCCs at a latter opportunity.</p></li>
</ul>
<p>The second approach has the advantaged of stalling the bus for a shorter period of
time, while the first guarantees the target will be assigned the desired address.</p>
</section>
<section id="word-command-interface">
<h3>Word Command Interface<a class="headerlink" href="#word-command-interface" title="Permalink to this heading"></a></h3>
<p>The word command interface is an internal interface between the Framing/DAA and
the Word modules, it is based on the patterns of the I3C specifications, allowing
to yield events as commands, for example, broadcasting the I3C 7’h7e and waiting
the ACK.</p>
<p>For cohesion, this interface uses the abbreviations from Fig. 168, p.397 from
MIPI I3C specification<a class="footnote-reference brackets" href="#f1" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>, e.g. the last example is BCAST_7E_W.</p>
<p>The command has two fields: header and body, the header is an enumeration of
the possible commands, and body is a 1-byte that depends on the header.</p>
</section>
<section id="configuration-registers">
<h3>Configuration Registers<a class="headerlink" href="#configuration-registers" title="Permalink to this heading"></a></h3>
</section>
</section>
<section id="offload-interface">
<span id="i3c-controller-offload-interface"></span><h2>Offload Interface<a class="headerlink" href="#offload-interface" title="Permalink to this heading"></a></h2>
<p>The offload interface allows to cyclic operation with SDI output to a DMA.
The offload commands are the same as in <a class="reference internal" href="#i3c-controller-command-descriptors"><span class="std std-ref">Command Descriptors</span></a>,
however no command receipt is emitted and less complex transactions are preferred
with this interface, specially that the I3C specification allows the peripheral to
reject a transfer;
in summary, are suitable of the offload interface register read transfers, e.g.
ADC readings.</p>
<p>To use this mode,
instead of writing the command to the CMD FIFO and the payloads to SDO FIFO:</p>
<ul class="simple">
<li><p>Write the command descriptors in sequence of execution to the OFFLOAD_CMD_*
registers.</p></li>
<li><p>Populate the OFFLOAD_SDO_* registers with the SDO payload, preserving unused
bytes slots (don’t mix different commands payload in the same address).</p></li>
<li><p>Update the OPS_OFFLOAD_LENGTH register subfield with the number of commands
descriptors.</p></li>
</ul>
<p>The offload logic will then execute a burst for each offload_trigger
(OPS_MODE must be ‘b1).
Also, one shall set the OPS_MODE to offload at the same write of the
OPS_OFFLOAD_LENGTH.</p>
</section>
<section id="the-block-ram-offload">
<h2>The Block RAM Offload<a class="headerlink" href="#the-block-ram-offload" title="Permalink to this heading"></a></h2>
<p>A 5-bit wide address, 32-bit data dual access block ram is used to store the
offload commands and SDO.</p>
<p>The bit 5 indicates if it’s a command descriptor (‘b0) or a SDO payload (‘b1).
The actual width of the address and data depends on the implementation, but in
general the 5-bit address is placed as a 16-bit address with the 11 MSB grounded.</p>
</section>
<section id="debugging-tips">
<h2>Debugging Tips<a class="headerlink" href="#debugging-tips" title="Permalink to this heading"></a></h2>
<p>To ease debugging with the ILA core, the following signals are recommended to be
sampled:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bit_mod:rx_raw</span></code>: SDI input after one register sampling (data).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bit_mod:scl</span></code>: SCL output (data).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">word:sm</span></code>: Current Word Command state (data).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framing:cmdp_ccc_id</span></code>: CCC ID without broadcast field (trigger, data).</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not sample the <code class="docutils literal notranslate"><span class="pre">bit_mod:sdo</span></code> signal, it will alter the SDA I/O logic and
the core won’t work properly.</p>
</div>
<p>The trigger at <code class="docutils literal notranslate"><span class="pre">cmd_parser:cmdp_ccc_id</span></code> allows to start the capture at the start
of the CCC of interest, then the other three debug signals provide a clear view of
the bus and the state of the state machine.</p>
<p>For the depth of the ILA core, between 4096 and 8192 is sufficient to sample whole
transfers.
In particular, 8192 with “Trigger position on window” set to 0 is sufficient to sample
a whole <code class="docutils literal notranslate"><span class="pre">ENTDAA</span></code> with 1 peripheral requesting address.</p>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="f0" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.mipi.org/MIPI_I3C_mandatory_data_byte_values_public">I3C MDB Values implementers table</a></p>
</aside>
<aside class="footnote brackets" id="f1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id3">2</a>)</span>
<p><a class="reference external" href="https://www.mipi.org/specifications/i3c-sensor-specification">I3C Basic Specification v1.1.1</a></p>
</aside>
</aside>
</section>
</section>


          </div>
              <div class="related">
                &nbsp;
    <a href="i3c_controller_core.html" title="Previous document (Alt+Shift+LeftArrow)" class="prev">I3C Controller Core</a>
    <a href="../jesd204/index.html" title="Next document (Alt+Shift+RightArrow)" class="next">JESD204 Interface Framework</a>
              </div>
          
        </div>
      </div>
  </div>

  <label id="cancel-area-show-toc" for="input-show-toc"></label>
  <label id="cancel-area-show-localtoc" for="input-show-localtoc"></label>
    <footer>
      &#169;2024, Analog Devices, Inc.
      
      |
      Made with <a href="https://www.sphinx-doc.org/">Sphinx</a>
      &amp; <a href="https://github.com/analogdevicesinc/doctools">Doctools</a>
      
    </footer>
  </body>
</html>